---
layout: default
title: 気象庁防災情報XML連携（PUSH型）
---

気象庁防災情報XMLとシラサギとを連携させ、

1. 震度5強以上の地震発生時に、緊急災害レイアウトに切り替える。
2. 大津波警報発生時に、職員にメールを送る。

などをシラサギにさせることができます。

この機能を有効にするには、まず利用申請を送り、その後、シラサギを設定していきます。

> ここで説明しているPUSH型の気象庁防災情報XMLは2020年（令和2年）8月末に終了することが決まっております。
> 新規に設定する場合は、v1.13.0 から利用可能な[PULL型による気象庁防災情報XMLの受信](/settings/jmaxml_pull.html)をご利用ください。

## 申請

気象庁防災情報XMLフォーマット形式電文の利用申請が必要です。
その方法を説明します。

1. 申請書の「subscriberのエンドポイントURL」
  1. フォルダー属性「RSS取込/気象庁防災情報XML」のフォルダーを作成
     "weather" というフォルダーを作成したとすると、
     subscriberのエンドポイントURLは、次のとおりとなります。
     ```
     http://demo.ss-proje.org/weather/subscriber
     ```
2. 申請書の「verify.tokenの登録を希望する場合はtokenを記載」
  1. ランダムな文字列を設定します。
3. 申請書の「登録を希望するatomフィードの分類種別」 
  1. 利用目的に応じて適切に選択します。

他の欄を適切に記入し、所定の手続きどおりに申請してください。

## 開通後

1. 申請の 1 で作成したフォルダーに受信した電文（XML）が格納されています。
2. フォルダー設定の変更
  1. 受信した電文が際限なく溜まっていくので「最大保存件数」を適切な値に設定します。
  2. 「HMAC Key」に、申請書の「verify.tokenの登録を希望する場合はtokenを記載」に記載したランダムな文字列を設定します。
  3. 設定を保存します。
3. 数時間待ってみて正しく電文（XML）を受信できていることを確認します。

## 気象庁防災情報XMLと連携して、何か動作をさせる設定

手順として:

1. 受信条件を作成します。
2. 受信時の動作を作成します。
3. 1 と 2 とを結びつける「フィルター」を作成します。

### 受信条件の作成

1. 申請の 1 で作成したフォルダーを開き、ナビメニューの「受信条件」をクリックします。
2. 条件を適切に作成します。例えば震度 5強以上の自身で何かアクションを起こしたい場合は、種別「地震速報」を選択し、震度から「5強」を選択します。


### 受信時の動作の作成

1. 申請の 1 で作成したフォルダーを開き、ナビメニューの「受信時の動作」をクリックします。
2. 動作を適切に作成します。例えば緊急災害レイアウトに切り替えたい場合は、種別「緊急災害レイアウト切替」を選択し、切り替えるレイアウトを選択します。


### フィルター作成

受信条件と受信時の動作とを結びつけます。

1. 申請の 1 で作成したフォルダーを開き、ナビメニューの「フォルダー設定」をクリックします。
2. 「フィルターを管理する」をクリックします。
3. 受信条件と受信時の動作とを設定します。受信時の動作は最大 5 つまで設定できます。


## 上手く連携できない時

1. Basic 認証がかかっていると電文を受信できません。
   フォルダー属性「RSS取込/気象庁防災情報XML」のフォルダーだけでも Basic 認証を解除してください。
